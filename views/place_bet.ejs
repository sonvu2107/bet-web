<!DOCTYPE html>
<html>
<head>
    <title>Đặt cược</title>
    <link rel="stylesheet" href="/style.css">
    <script>
        function onMatchChange(sel) {
            window.location = '/bet/place?match=' + encodeURIComponent(sel.value);
        }
    </script>
</head>
<body>
<div class="container">
    <h2>Đặt cược</h2>

    <form method="POST" action="/bet">
        <label>Chọn trận đấu:</label>
        <select name="match" required onchange="onMatchChange(this)">
            <% activeMatches.forEach(m => { %>
                <option value="<%= m.name %>" <%= selectedMatchName === m.name ? 'selected' : '' %>>
                    <%= m.name %>
                </option>
            <% }) %>
        </select><br><br>

        <% if (teams && teams.length > 0) { %>
            <label>Chọn đội:</label>
            <select name="team" required>
                <% teams.forEach(t => { %>
                    <option value="<%= t %>"><%= t %></option>
                <% }) %>
            </select><br><br>
        <% } else { %>
            <p>⚠️ Không tìm thấy đội nào cho trận này.</p>
        <% } %>

        <label>Số điểm đặt cược:</label>
        <input type="number" name="amount" min="1" required><br><br>

        <button type="submit" class="btn return-home">Đặt cược</button>
    </form>

    <h3>Lịch sử cược</h3>
    <% if (bets && bets.length > 0) { %>
        <ul>
            <% bets.forEach(b => { %>
                <li>
                    Trận: <%= b.match %> | Đội: <%= b.team %> |
                    Số điểm: <%= b.amount %> |
                    Kết quả:
                    <% if (b.result === 'win') { %>
                        ✅ Thắng
                    <% } else if (b.result === 'lose') { %>
                        ❌ Thua
                    <% } else { %>
                        ⏳ Đang chờ
                    <% } %>
                </li>
            <% }) %>
        </ul>
    <% } else { %>
        <p>Bạn chưa đặt cược trận nào.</p>
    <% } %>

    <p><a class="btn return-home" href="/">Quay lại trang chủ</a></p>
</div>
</body>
</html>
